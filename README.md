# Geek_homework

Golang class homework in Geek Space.

## Table of Contents

- [Week01: å®ç°åˆ‡ç‰‡çš„åˆ é™¤æ“ä½œ](#Week01)
- [Week02: å®ç°ç”¨æˆ·ä¿¡æ¯ç¼–è¾‘åŠŸèƒ½](#Week02)
- [Week03: éƒ¨ç½²æ–¹æ¡ˆä¿®æ”¹](#Week03)
- [Week04ï¼šå¼•å…¥æœ¬åœ°ç¼“å­˜](#Week04)

---

<h2 id="Week01">Week01: å®ç°åˆ‡ç‰‡çš„åˆ é™¤æ“ä½œ</h2>

[GitHub Link](https://github.com/ycvk/geek_homework/tree/main/week01)

### ä½œä¸šè¦æ±‚

- **å®ç°åˆ é™¤åˆ‡ç‰‡ç‰¹å®šä¸‹æ ‡å…ƒç´ çš„æ–¹æ³•ã€‚**

- **æ€§èƒ½è¦æ±‚ï¼š** å®ç°ç›¸å¯¹é«˜æ€§èƒ½çš„åˆ é™¤æ“ä½œã€‚

- **æ³›å‹åŒ–ï¼š** æ”¹é€ ä¸ºæ”¯æŒæ³›å‹çš„æ–¹æ³•ã€‚

- **ç¼©å®¹æœºåˆ¶ï¼š** æ·»åŠ ç¼©å®¹æ”¯æŒï¼Œå¹¶è®¾è®¡ç¼©å®¹æœºåˆ¶ã€‚

---

<h2 id="Week02">Week02: å®ç°ç”¨æˆ·ä¿¡æ¯ç¼–è¾‘åŠŸèƒ½</h2>

[GitHub Link](https://github.com/ycvk/geek_homework/tree/main/tinybook)

### ä½œä¸šè¦æ±‚

1. **å®Œå–„ `/users/edit` æ¥å£**

2. **å…è®¸çš„ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**
    - æ˜µç§°ï¼šå­—ç¬¦ä¸²ï¼ˆé™åˆ¶é•¿åº¦ï¼‰
    - ç”Ÿæ—¥ï¼šæ—¥æœŸå­—ç¬¦ä¸²ï¼ˆå¦‚ "1992-01-01"ï¼‰
    - ä¸ªäººç®€ä»‹ï¼šæ–‡æœ¬ï¼ˆé™åˆ¶é•¿åº¦ï¼‰

3. **è¾“å…¥æ ¡éªŒ**ï¼šå®ç°è¾“å…¥å†…å®¹çš„æ ¡éªŒï¼Œå¹¶è¿”å›å‡†ç¡®ä¿¡æ¯ã€‚

4. **ç”¨æˆ·èµ„æ–™æ¥å£ï¼š** ä¿®æ”¹ `/users/profile` æ¥å£ä»¥å±•ç¤ºæ–°æ·»åŠ çš„ä¿¡æ¯ã€‚

5. **å“åº”æˆªå›¾ï¼š** æäº¤ Postman å“åº”æˆªå›¾ã€‚

6. **é™„åŠ æ–‡æ¡£ï¼š** æ·»åŠ  README æ–‡ä»¶ï¼Œå¹¶é™„å¸¦ç¤ºæ„å›¾ã€‚

7. **ä»£ç æ›´æ–°ï¼š** åœ¨ `record` åˆ†æ”¯ä¸Šè¡¥å…… `Edit` å’Œ `Profile` æ¥å£ã€‚

### Postman å“åº”æˆªå›¾

<details>
  <summary>ç‚¹å‡»å±•å¼€å›¾ç‰‡</summary>

![post_01](https://i.mji.rip/2023/10/02/73405f3b359c19579beaaa5fb4fb588e.png)
![post_02](https://i.mji.rip/2023/10/02/2c01cc2c383c90dfea1d2ff39612d0c0.png)

</details>

### å‰ç«¯è¯·æ±‚é¢„è§ˆ

<details>
  <summary>ç‚¹å‡»å±•å¼€å›¾ç‰‡</summary>

<img src="https://i.mji.rip/2023/10/02/23b5761e808f0d6b12a3582d8fa39dbf.png" width="50%" height="50%" alt="web_01" />

<img src="https://i.mji.rip/2023/10/02/f8b1662852a50f852884534bbb4b1876.png" width="50%" height="50%" alt="web_02" />

<img src="https://i.mji.rip/2023/10/12/c298dd3635e8b41562a377f98be29cb1.png" width="50%" height="50%" alt="web_03" />

<img src="https://i.mji.rip/2023/10/12/3fb6326899142d4b0903ec785dd646c2.png" width="50%" height="50%" alt="web_04" />

<img src="https://i.mji.rip/2023/10/12/523ea485027beee9f6e381a53f8db630.png" width="50%" height="50%" alt="web_05" />

<img src="https://i.mji.rip/2023/10/12/b8377b4813aee91d9997b6d07291c744.png" width="50%" height="50%" alt="web_06" />

</details>

---

<h2 id="Week03">Week03: éƒ¨ç½²æ–¹æ¡ˆä¿®æ”¹</h2>

[GitHub Link](https://github.com/ycvk/geek_homework)

### ä½œä¸šè¦æ±‚

1. **é¡¹ç›®ç«¯å£ï¼š** ä¿®æ”¹é¡¹ç›®å¯åŠ¨ç«¯å£ä¸º 8081ã€‚

2. **Pod æ•°é‡ï¼š** å°†é¡¹ç›®éƒ¨ç½²ä¸º 2 ä¸ª Podã€‚

3. **Redis ç«¯å£ï¼š** ä¿®æ”¹ Redis è®¿é—®ç«¯å£ä¸º 6380ã€‚

4. **MySQL ç«¯å£ï¼š** ä¿®æ”¹ MySQL è®¿é—®ç«¯å£ä¸º 3308ã€‚

### éœ€è¦æäº¤çš„å†…å®¹

- `kubectl get services` çš„æˆªå›¾ã€‚
- `kubectl get pods` çš„æˆªå›¾ã€‚
- é€šè¿‡æµè§ˆå™¨è®¿é—® Tinybook é¡¹ç›®å¹¶è·å¾—æ­£ç¡®å“åº”çš„æˆªå›¾ã€‚

### kubectl æˆªå›¾

![kubectl_01](https://i.mji.rip/2023/10/15/95d24d6ba5ecba314592afe22bacb45b.png)

### æµè§ˆå™¨è®¿é—®æˆªå›¾

<details>
  <summary>ç‚¹å‡»å±•å¼€å›¾ç‰‡</summary>

#### Profile é¡µé¢

![web_01](https://i.mji.rip/2023/10/15/fbed29fab3a8267054635fbbb893e6e9.png)

#### Edit é¡µé¢

![web_02](https://i.mji.rip/2023/10/15/fe1d30f80d88b5f10f284df3e6a2149f.png)

#### Login é¡µé¢

![web_03](https://i.mji.rip/2023/10/15/deddbe2bf427c55e2837d45497e6329b.png)

</details>

---

<h2 id="Week04">Week04ï¼šå¼•å…¥æœ¬åœ°ç¼“å­˜</h2>

[GitHub Link](https://github.com/ycvk/geek_homework/tree/week04)

### ä½œä¸šè¦æ±‚

1. **é‡æ„ç°æœ‰çš„CodeCache**ï¼š
    - å°†å½“å‰çš„ `CodeCache` æ”¹åä¸º `CodeRedisCache`ã€‚

2. **å®ç°æœ¬åœ°ç¼“å­˜çš„CodeCache**ï¼š
    - è‡ªç”±é€‰æ‹©æœ¬åœ°ç¼“å­˜æŠ€æœ¯ï¼Œæ³¨æ„ä½“ä¼šæŠ€æœ¯é€‰å‹çš„å…³é”®å› ç´ ã€‚

3. **å¹¶å‘å®‰å…¨**ï¼š
    - ç¡®ä¿åœ¨å•æœºæˆ–å¼€å‘ç¯å¢ƒä¸‹å¹¶å‘å®‰å…¨ã€‚

<details>
  <summary>ğŸ‘‰ ç‚¹å‡»å±•å¼€ç»“æœ</summary>

### æŠ€æœ¯é€‰å‹

#### çƒ­é—¨æœ¬åœ°ç¼“å­˜åº“ä¸€è§ˆ

[freecache](https://github.com/coocood/freecache)

[bigcache](https://github.com/allegro/bigcache)

[fastcache](https://github.com/VictoriaMetrics/fastcache)

[ristretto](https://github.com/dgraph-io/ristretto)

[go-cache](https://github.com/patrickmn/go-cache)

[theine-go](https://github.com/Yiling-J/theine-go)

| ç¼“å­˜åº“       | ä¼˜ç‚¹                              | ç¼ºç‚¹                                                                   | æ˜¯å¦æ”¯æŒTTL | å†…å­˜æ•ˆç‡ | é€‚ç”¨åœºæ™¯                | å¹¶å‘å®‰å…¨ | ç¤¾åŒºæ´»è·ƒåº¦ |
|-----------|---------------------------------|----------------------------------------------------------------------|---------|------|---------------------|------|-------|
| freecache | è¿‘ä¼¼LRUæ·˜æ±°ï¼Œæ”¯æŒKeyè®¾ç½®TTL              | éœ€è¦æå‰çŸ¥é“ç¼“å­˜å¤§å°ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜æµªè´¹                                                  | æ˜¯       | ä¸­ç­‰   | é«˜å¹¶å‘ã€å†…å­˜æ•æ„Ÿç¯å¢ƒ          | æ˜¯    | ä¸­ç­‰    |
| bigcache  | ä¸éœ€è¦æå‰çŸ¥é“ç¼“å­˜å¤§å°ï¼Œèƒ½åŠ¨æ€æ‰©å±•               | æœ‰åºåˆ—åŒ–å¼€é”€ï¼Œç¼“å­˜æ·˜æ±°æ•ˆç‡å·®ï¼Œæ— æ³•ä¸ºæ¯ä¸ªkeyè®¾ç½®TTLï¼Œä¼šåœ¨å†…å­˜ä¸­åˆ†é…å¤§æ•°ç»„ç”¨ä»¥è¾¾åˆ° 0 GC çš„ç›®çš„ï¼Œä¸€å®šç¨‹åº¦ä¸Šä¼šå½±å“åˆ° GC é¢‘ç‡ | æ˜¯       | é«˜    | åŠ¨æ€æ•°æ®é‡ï¼Œéœ€è¦å¿«é€Ÿæ‰©å±•çš„åœºæ™¯     | æ˜¯    | é«˜     |
| fastcache | æ€§èƒ½é«˜ï¼Œåˆ†ç‰‡é™ä½é”ç²’åº¦ï¼Œç´¢å¼•å­˜å‚¨ä¼˜åŒ–              | ä¸æ”¯æŒTTL                                                               | å¦       | é«˜    | é«˜æ€§èƒ½éœ€æ±‚ï¼Œä¸éœ€è¦TTLç®¡ç†      | æ˜¯    | é«˜     |
| ristretto | é«˜æ€§èƒ½ï¼Œæœ‰å‡†å…¥æ”¿ç­–å’ŒSampledLFUé©±é€æ”¿ç­–        | å¯¹GCæ— ä¼˜åŒ–ï¼Œå†…éƒ¨ä½¿ç”¨ sync.map                                                 | æ˜¯       | é«˜    | é«˜æ€§èƒ½éœ€æ±‚ï¼Œéœ€è¦ç²¾ç»†æ§åˆ¶æ·˜æ±°ç­–ç•¥çš„åœºæ™¯ | æ˜¯    | é«˜     |
| go-cache  | æ˜“äºä½¿ç”¨ï¼Œé•¿æ—¶é—´ç»´æŠ¤                      | é•¿ä¹…æœªæ›´æ–°ï¼Œå¯èƒ½å­˜åœ¨æ½œåœ¨çš„å®‰å…¨å’Œæ€§èƒ½é—®é¢˜                                                 | æ˜¯       | ä½    | ç®€å•ç¼“å­˜éœ€æ±‚ï¼Œä¸å…³å¿ƒé•¿æœŸç»´æŠ¤å’Œæ‰©å±•æ€§  | æ˜¯    | ä½     |
| theine-go | æ”¯æŒTTLä¸æŒä¹…åŒ–ï¼Œè‡ªé€‚åº”W-TinyLFUæ·˜æ±°ç­–ç•¥ï¼Œé«˜å‘½ä¸­ç‡ | ç›¸å¯¹è¾ƒæ–°ï¼Œç¤¾åŒºæ”¯æŒå¯èƒ½è¾ƒå°‘                                                        | æ˜¯       | é«˜    | éœ€è¦TTLç®¡ç†å’ŒæŒä¹…åŒ–ï¼Œé«˜å‘½ä¸­ç‡è¦æ±‚  | æ˜¯    | ä¸ç¡®å®š   |

ç»¼ä¸Šæ‰€è¿°ï¼Œæœ¬æ¬¡ä½œä¸šå¯ä»¥é€‰ç”¨ `ristretto` æˆ– `theine-go` ä½œä¸ºæœ¬åœ°ç¼“å­˜ã€‚

##### å‚è€ƒé“¾æ¥

[æ€§èƒ½æ•æ„Ÿåœºæ™¯ä¸‹ï¼ŒGo ä¸‰æ–¹åº“çš„é€‰å‹æ€è·¯å’Œæ¡ˆä¾‹åˆ†æ](https://blog.csdn.net/kevin_tech/article/details/125437607)

[golangæœ¬åœ°ç¼“å­˜(bigcache/freecache/fastcacheç­‰)é€‰å‹å¯¹æ¯”åŠåŸç†æ€»ç»“ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/487455942)

### å®ç°ä¸æµ‹è¯•

#### ä»£ç å®ç°

- [service å±‚](https://github.com/ycvk/geek_homework/blob/week04/tinybook/internal/service/code.go)
- [repository å±‚](https://github.com/ycvk/geek_homework/blob/week04/tinybook/internal/repository/code.go)
- [cache å±‚](https://github.com/ycvk/geek_homework/blob/d6f037683884b41ccb56c20bc8f6425fe8fe8ad6/tinybook/internal/repository/cache/code.go#L29-L94) (
  ä½¿ç”¨ `theine-go` ä½œä¸ºæœ¬åœ°ç¼“å­˜, é€»è¾‘è¯¦è§ä»£ç æ³¨é‡Š)
- [wire DI å±‚](https://github.com/ycvk/geek_homework/blob/d6f037683884b41ccb56c20bc8f6425fe8fe8ad6/tinybook/wire.go#L25) (
  ä¾èµ–æ³¨å…¥æ—¶, ä½¿ç”¨ `LocalCodeCache` æ›¿æ¢ `CodeRedisCache`)

#### æµ‹è¯•ç»“æœ

##### 1. å‘é€éªŒè¯ç ä¸ç™»å½•

![test_01](https://github.com/ycvk/PicDemo/blob/main/8325afc6715b05b8290ef82597ddd98a.png?raw=true)

##### 2. å†æ¬¡ä½¿ç”¨æ­¤éªŒè¯ç ç™»å½•

![test_02](https://github.com/ycvk/PicDemo/blob/main/26874c3dafaa801849828b3b057d3391.png?raw=true)

##### 3. ç‚¹å‡»ç™»å½•è¶…è¿‡ 3 æ¬¡

![test_03](https://github.com/ycvk/PicDemo/blob/main/d46be533a394741ec42730c58eb4e536.png?raw=true)

##### 4. çŸ­æ—¶é—´å†…å‘é€éªŒè¯ç è¶…è¿‡ 3 æ¬¡

![test_04](https://github.com/ycvk/PicDemo/blob/main/WeChat4dbea418d336ac0b3bb35dc63de2296c.jpg?raw=true)

</details>